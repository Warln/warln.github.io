/*! K 3.0.0-beta.25 | http://www.getuikit.com | (c) 2014 - 2017 YOOtheme | MIT License */

!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define("uikitlightbox",i):t.KLightbox=i()}(this,function(){"use strict";function t(i){function e(t,i,e){void 0===e&&(e="in"),l[e](t.attr("hidden",!1),i).then(function(){"out"===e&&t.attr("hidden",!0)})}function n(t,i,e,n,s,o){return t=t in q?q[t]:q.slide,{show:function(a,h){void 0===h&&(h=0),a-=Math.round(a*h);var l=t.show(s);return this.translate(h),C.all([_.start(e,l[0],a,i),_.start(n,l[1],a,i)]).then(function(){for(var t in l[0])r([n[0],e[0]]).css(t,"");o()},k)},stop:function(){return C.all([_.stop(n),_.stop(e)])},forward:function(i){var s=this,o=t.percent(e);return C.all([_.cancel(n),_.cancel(e)]).then(function(){return s.show(i,o)})},translate:function(i){var o=t.translate(i,s);e.css(o[0]),n.css(o[1])}}}function s(t,i,e){return'<iframe src="'+t+'" width="'+i+'" height="'+e+'" style="max-width: 100%; box-sizing: border-box;" video responsive></iframe>'}if(!t.installed){var o=i.mixin,a=i.util,r=a.$,h=a.$trigger,l=a.Animation,u=a.ajax,c=a.assign,d=a.doc,m=a.docElement,g=a.fastdom,p=a.getData,f=a.getImage,v=a.getIndex,k=a.noop,b=a.on,x=a.off,w=a.pointerDown,I=a.pointerMove,y=a.pointerUp,$=a.preventClick,C=a.promise,P=a.requestAnimationFrame,_=a.Transition;i.component("lightbox",{attrs:!0,props:{animation:String,toggle:String},defaults:{animation:void 0,toggle:"a"},computed:{toggles:function(){var t=this,i=r(this.toggle,this.$el);return this._changed=!this._toggles||i.length!==this._toggles.length||i.toArray().some(function(i,e){return i!==t._toggles.get(e)}),this._toggles=i}},disconnected:function(){this.panel&&(this.panel.$destroy(!0),this.panel=null)},events:[{name:"click",delegate:function(){return this.toggle+":not(.disabled)"},handler:function(t){t.preventDefault(),this.show(this.toggles.index(t.currentTarget))}}],update:function(){this.panel&&this.animation&&(this.panel.$props.animation=this.animation,this.panel.$emit()),this.toggles.length&&this._changed&&this.panel&&(this.panel.$destroy(!0),this._init())},methods:{_init:function(){return this.panel=this.panel||i.lightboxPanel({animation:this.animation,items:this.toggles.toArray().reduce(function(t,i){return t.push(["href","caption","type"].reduce(function(t,e){return t["href"===e?"source":e]=p(i,e),t},{})),t},[])})},show:function(t){return this.panel||this._init(),this.panel.show(t)},hide:function(){return this.panel&&this.panel.hide()}}}),i.component("lightbox-panel",{mixins:[o.togglable],functional:!0,defaults:{animation:"slide",transition:"ease",duration:400,attrItem:"lightbox-item",preload:1,items:[],index:0,clsPage:"lightbox-page",clsItem:"lightbox-item",stack:[],threshold:15,percent:0,cls:"open",clsActive:"active",delayControls:3e3,template:'\n                <div class="lightbox overflow-hidden">\n                    <ul class="lightbox-items"></ul>\n                    <div class="lightbox-toolbar position-top text-right">\n                        <button class="lightbox-toolbar-icon close-large" type="button" close toggle="!.lightbox"></button>\n                     </div>\n                    <a class="lightbox-button position-center-left position-medium" href="#" slidenav-previous lightbox-item="previous"></a>\n                    <a class="lightbox-button position-center-right position-medium" href="#" slidenav-next lightbox-item="next"></a>\n                    <div class="lightbox-toolbar lightbox-caption position-bottom text-center"></div>\n                </div>'},computed:{container:function(){return r(!0===this.$props.container&&i.container||this.$props.container||i.container)},slides:function(){return this.list.children("."+this.clsItem)},forwardDuration:function(){return this.duration/4}},created:function(){var t=this;this.$mount(r(this.template).appendTo(this.container)[0]),this.list=this.$el.find(".lightbox-items"),this.toolbars=this.$el.find(".lightbox-toolbar"),this.nav=this.$el.find("a[lightbox-item]"),this.caption=this.$el.find(".lightbox-caption"),this.items.forEach(function(i,e){return t.list.append('<li class="'+t.clsItem+" item-"+e+'"></li>')})},init:function(){var t=this;["start","move","end"].forEach(function(i){var e=t[i];t[i]=function(i){i=i.originalEvent||i,t.prevPos=t.pos,t.pos=(i.touches&&i.touches[0]||i).pageX,e(i)}})},events:[{name:I+" "+w+" keydown",handler:"showControls"},{name:"click",self:!0,handler:function(t){t.preventDefault(),this.hide()}},{name:"click",self:!0,delegate:function(){return"."+this.clsItem},handler:function(t){t.preventDefault(),this.hide()}},{name:"click",delegate:function(){return"["+this.attrItem+"]"},handler:function(t){t.preventDefault(),this.show(r(t.currentTarget).attr(this.attrItem))}},{name:"show",self:!0,handler:function(){this.$addClass(m,this.clsPage)}},{name:"shown",self:!0,handler:function(){this.$addClass(this.caption,"animation-slide-bottom"),this.toolbars.attr("hidden",!0),this.nav.attr("hidden",!0),this.showControls()}},{name:"hide",self:!0,handler:function(){this.$removeClass(this.caption,"animation-slide-bottom"),this.toolbars.attr("hidden",!0),this.nav.attr("hidden",!0)}},{name:"hidden",self:!0,handler:function(){this.$removeClass(m,this.clsPage)}},{name:"keydown",el:function(){return d},handler:function(t){if(this.isToggled(this.$el))switch(t.keyCode){case 27:this.hide();break;case 37:this.show("previous");break;case 39:this.show("next")}}},{name:"toggle",handler:function(t){t.preventDefault(),this.toggle()}},{name:w,delegate:function(){return"."+this.clsItem},handler:"start"}],methods:{start:function(t){var i=this;if(!t.button||0===t.button){if(t.preventDefault(),this.stack.length)return this.stack.splice(1),void(this._animation&&this._animation.stop().then(function(){return i.start(t)}));b(d,I,this.move,!0),b(d,y,this.end,!0),this.touch={start:this.pos,current:this.slides.eq(this.index),prev:this.slides.eq(this.getIndex("previous")),next:this.slides.eq(this.getIndex("next"))}}},move:function(){var t=this.touch,i=t.start,e=t.current,s=t.next,o=t.prev;if(!(this.pos===this.prevPos||!this.touching&&Math.abs(i-this.pos)<this.threshold)){this.touching=!0;var a=(this.pos-i)/e.outerWidth();this.percent!==a&&(this.percent=a,this.$toggleClass(s,this.clsActive,a<0),this.$toggleClass(o,this.clsActive,a>=0),new n(this.animation,this.transition,e,a>=0?o:s,a<0?1:-1,k).translate(Math.abs(a)))}},end:function(t){if(t.preventDefault(),x(d,I,this.move,!0),x(d,y,this.end,!0),this.touching){var i=this.percent;this.percent=Math.abs(this.percent),this.percent<.2&&(this.index=this.getIndex(i>0?"previous":"next"),this.percent=1-this.percent,i*=-1),this.show(i>0?"previous":"next",!0),$()}this.pos=this.prevPos=this.touch=this.touching=this.percent=null},toggle:function(){return this.isToggled()?this.hide():this.show()},show:function(t,e){var s=this;void 0===e&&(e=!1);var o=this.items.length>1;if(this.isToggled()||(this.toggleNow(this.$el,!0),o=!1),e||!this.touch)if(this.stack[e?"unshift":"push"](t),!e&&this.stack.length>1)2===this.stack.length&&this._animation.forward(this.forwardDuration);else{var a="next"===t?1:-1;t=this.getIndex(t);var r=o&&this.slides.eq(this.index),h=this.slides.eq(t);this.index=t,this.$addClass(h,this.clsActive);var l=this.getItem(t).caption;this.caption.toggle(!!l).text(l),this._animation=new n(r?this.animation:"scale",this.transition,r||h,h,a,function(){r&&s.$removeClass(r,s.clsActive),s.stack.shift(),s.stack.length?P(function(){return s.show(s.stack.shift(),!0)}):s._animation=null,s.$el.trigger("itemshown",[s,h]),r&&(s.$el.trigger("itemhidden",[s,r]),i.update(null,r))}),this._animation.show(this.stack.length>1?this.forwardDuration:this.duration,this.percent);for(var u=0;u<=this.preload;u++)s.loadItem(s.getIndex(t+u)),s.loadItem(s.getIndex(t-u));this.$el.trigger("itemshow",[this,h]),r&&this.$el.trigger("itemhide",[this,r]),i.update(null,h),g.flush()}},hide:function(){this.isToggled()&&this.toggleNow(this.$el,!1),this.slides.removeClass(this.clsActive).each(function(t,i){return _.stop(i)}),delete this.index,delete this.percent,delete this._animation},loadItem:function(t){void 0===t&&(t=this.index);var i=this.getItem(t);i.content||(this.setItem(i,"<span spinner></span>"),h(this.$el,"itemload",[i],!0).isImmediatePropagationStopped()||this.setError(i))},getItem:function(t){return void 0===t&&(t=this.index),this.items[t]||{source:"",caption:"",type:""}},setItem:function(t,e){c(t,{content:e});var n=this.slides.eq(this.items.indexOf(t)).html(e);this.$el.trigger("itemloaded",[this,n]),i.update(null,n)},setError:function(t){this.setItem(t,'<span icon="icon: bolt; ratio: 2"></span>')},getIndex:function(t){return void 0===t&&(t=this.index),v(t,this.items,this.index)},showControls:function(){clearTimeout(this.controlsTimer),this.controlsTimer=setTimeout(this.hideControls,this.delayControls),this.toolbars.attr("hidden")&&(e(this.toolbars.eq(0),"animation-slide-top"),e(this.toolbars.eq(1),"animation-slide-bottom"),this.nav.attr("hidden",this.items.length<=1),this.items.length>1&&(e(this.nav.eq(0),"animation-fade"),e(this.nav.eq(1),"animation-fade")))},hideControls:function(){this.toolbars.attr("hidden")||(e(this.toolbars.eq(0),"animation-slide-top","out"),e(this.toolbars.eq(1),"animation-slide-bottom","out"),this.items.length>1&&(e(this.nav.eq(0),"animation-fade","out"),e(this.nav.eq(1),"animation-fade","out")))}}});var q={fade:{show:function(){return[{opacity:0},{opacity:1}]},percent:function(t){return 1-t.css("opacity")},translate:function(t){return[{opacity:1-t},{opacity:t}]}},slide:{show:function(t){return[{transform:"translate3d("+-1*t*100+"%, 0, 0)"},{transform:"translate3d(0, 0, 0)"}]},percent:function(t){return Math.abs(t.css("transform").split(",")[4]/t.outerWidth())},translate:function(t,i){return[{transform:"translate3d("+-100*i*t+"%, 0, 0)"},{transform:"translate3d("+100*i*(1-t)+"%, 0, 0)"}]}},scale:{show:function(){return[{opacity:0,transform:"scale3d(0.8, 0.8, 1)"},{opacity:1,transform:"scale3d(1, 1, 1)"}]},percent:function(t){return 1-t.css("opacity")},translate:function(t){var i=1-.2*t,e=.8+.2*t;return[{opacity:1-t,transform:"scale3d("+i+", "+i+", 1)"},{opacity:t,transform:"scale3d("+e+", "+e+", 1)"}]}}};i.mixin({events:{itemload:function(t,i){var e=this;("image"===i.type||i.source&&i.source.match(/\.(jp(e)?g|png|gif|svg)$/i))&&(f(i.source).then(function(t){return e.setItem(i,'<img width="'+t.width+'" height="'+t.height+'" src ="'+i.source+'">')},function(){return e.setError(i)}),t.stopImmediatePropagation())}}},"lightboxPanel"),i.mixin({events:{itemload:function(t,i){var e=this;if("video"===i.type||i.source&&i.source.match(/\.(mp4|webm|ogv)$/i)){var n=r("<video controls playsinline video></video>").on("loadedmetadata",function(){return e.setItem(i,n.attr({width:n[0].videoWidth,height:n[0].videoHeight}))}).on("error",function(){return e.setError(i)}).attr("src",i.source);t.stopImmediatePropagation()}}}},"lightboxPanel"),i.mixin({events:{itemload:function(t,i){var e=this,n=i.source.match(/\/\/.*?youtube\.[a-z]+\/watch\?v=([^&\s]+)/)||i.source.match(/youtu\.be\/(.*)/);if(n){var o=n[1],a=function(t,n){return void 0===t&&(t=640),void 0===n&&(n=320),e.setItem(i,s("//www.youtube.com/embed/"+o,t,n))};f("//img.youtube.com/vi/"+o+"/maxresdefault.jpg").then(function(t){120===t.width&&90===t.height?f("//img.youtube.com/vi/"+o+"/0.jpg").then(function(){return a(t.width,t.height)},a):a(t.width,t.height)},a),t.stopImmediatePropagation()}}}},"lightboxPanel"),i.mixin({events:{itemload:function(t,i){var e=this,n=i.source.match(/(\/\/.*?)vimeo\.[a-z]+\/([0-9]+).*?/);n&&(u({type:"GET",url:"http://vimeo.com/api/oembed.json?url="+encodeURI(i.source),jsonp:"callback",dataType:"jsonp"}).then(function(t){var o=t.height,a=t.width;return e.setItem(i,s("//player.vimeo.com/video/"+n[2],a,o))}),t.stopImmediatePropagation())}}},"lightboxPanel")}}return"undefined"!=typeof window&&window.K&&window.K.use(t),t});